<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>员工住房公积金缴纳信息登记系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #1a2530 100%);
            color: white;
            padding: 25px 0;
            text-align: center;
            border-bottom: 5px solid #2980b9;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .header-content i {
            font-size: 2.8rem;
            margin-bottom: 15px;
            color: #3498db;
        }
        
        h1 {
            font-size: 2.4rem;
            font-weight: 600;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .registration-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eaeaea;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 12px;
            color: #3498db;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1rem;
        }
        
        .required::after {
            content: " *";
            color: #e74c3c;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #dce1e6;
            border-radius: 4px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: #fcfcfc;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            background-color: white;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .calculation-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-top: 20px;
            border-left: 4px solid #2ecc71;
        }
        
        .calc-results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .calc-item {
            background-color: white;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
        }
        
        .calc-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        .calc-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .actions {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 160px;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(41, 128, 185, 0.3);
        }
        
        .btn-secondary {
            background-color: #7f8c8d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #6c7b7d;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
        }
        
        .btn-verify {
            background-color: #9b59b6;
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
            min-width: auto;
        }
        
        .btn-verify:hover {
            background-color: #8e44ad;
        }
        
        .btn-verify:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .preview-section {
            margin-top: 40px;
            display: none;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .preview-table th {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .preview-table td {
            padding: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .preview-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .preview-table tr:hover {
            background-color: #edf7ff;
        }
        
        .validation-error {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }
        
        .validation-error.show {
            display: block;
        }
        
        .input-error {
            border-color: #e74c3c !important;
        }
        
        .input-error:focus {
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.2) !important;
        }
        
        .info-box {
            background-color: #e8f4fc;
            border-left: 4px solid #3498db;
            padding: 18px;
            margin-bottom: 25px;
            border-radius: 0 4px 4px 0;
            font-size: 0.95rem;
        }
        
        .verification-container {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }
        
        .verification-container input {
            flex: 1;
        }
        
        .verification-container .btn-verify {
            margin-top: 0;
            white-space: nowrap;
        }
        
        footer {
            text-align: center;
            padding: 25px 0;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eaeaea;
            margin-top: 50px;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #e0e0e0;
            z-index: 1;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #e0e0e0;
            color: #777;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .step.active .step-number {
            background-color: #3498db;
            color: white;
        }
        
        .step.completed .step-number {
            background-color: #27ae60;
            color: white;
        }
        
        .step-label {
            font-size: 0.9rem;
            color: #777;
        }
        
        .step.active .step-label {
            color: #3498db;
            font-weight: 600;
        }
        
        .step.completed .step-label {
            color: #27ae60;
        }
        
        .security-note {
            background-color: #fff8e1;
            border-left: 4px solid #f1c40f;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #7d6608;
        }
        
        .security-note i {
            color: #f39c12;
            margin-right: 8px;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content i {
                font-size: 2.2rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .btn {
                width: 100%;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .step-indicator {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .step {
                flex: 0 0 calc(50% - 15px);
            }
            
            .verification-container {
                flex-direction: column;
            }
            
            .verification-container .btn-verify {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .registration-card {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .step {
                flex: 0 0 100%;
            }
            
            .step-indicator::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <i class="fas fa-house-user"></i>
                <h1>员工住房公积金缴纳信息登记系统</h1>
                <p class="subtitle">用于员工住房补贴发放的住房公积金缴纳信息登记与管理。请认真填写以下信息，确保数据准确无误。</p>
            </div>
        </div>
    </header>
    
    <div class="container">
        <!-- 步骤指示器 -->
        <div class="step-indicator">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <div class="step-label">基本信息</div>
            </div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <div class="step-label">缴纳信息</div>
            </div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <div class="step-label">银行信息</div>
            </div>
            <div class="step" id="step4">
                <div class="step-number">4</div>
                <div class="step-label">预览确认</div>
            </div>
        </div>
        
        <!-- 信息提示 -->
        <div class="info-box">
            <i class="fas fa-info-circle"></i> 本系统用于收集员工住房公积金缴纳信息，作为住房补贴发放的依据。所有信息将严格保密，仅用于公司内部补贴发放流程。
        </div>
        
        <!-- 登记表单 -->
        <div class="registration-card">
            <h2 class="section-title"><i class="fas fa-user-edit"></i> 员工住房公积金缴纳信息登记</h2>
            
            <form id="registrationForm">
                <!-- 基本信息 -->
                <div id="basicInfoSection">
                    <h3 class="section-title" style="font-size: 1.3rem; margin-top: 25px;">基本信息</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="employeeName" class="required">员工姓名</label>
                            <input type="text" id="employeeName" name="employeeName" placeholder="请输入员工姓名">
                            <div class="validation-error" id="nameError">请输入有效的员工姓名</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="employeeId" class="required">员工工号</label>
                            <input type="text" id="employeeId" name="employeeId" placeholder="请输入员工工号">
                            <div class="validation-error" id="idError">请输入有效的员工工号</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="idNumber" class="required">身份证号码</label>
                            <input type="text" id="idNumber" name="idNumber" placeholder="请输入18位身份证号码" maxlength="18">
                            <div class="validation-error" id="idNumberError">请输入有效的18位身份证号码</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="mobilePhone" class="required">手机号码</label>
                            <input type="tel" id="mobilePhone" name="mobilePhone" placeholder="请输入11位手机号码" maxlength="11">
                            <div class="validation-error" id="mobilePhoneError">请输入有效的11位手机号码</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="verificationCode" class="required">短信验证码</label>
                            <div class="verification-container">
                                <input type="text" id="verificationCode" name="verificationCode" placeholder="请输入6位验证码" maxlength="6">
                                <button type="button" class="btn btn-verify" id="sendCodeBtn">
                                    <i class="fas fa-sms"></i> 发送验证码
                                </button>
                            </div>
                            <div class="validation-error" id="verificationCodeError">请输入正确的6位验证码</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="department" class="required">所属部门</label>
                            <select id="department" name="department">
                                <option value="">请选择部门</option>
                                <option value="technology">技术部</option>
                                <option value="marketing">市场部</option>
                                <option value="finance">财务部</option>
                                <option value="hr">人力资源部</option>
                                <option value="operations">运营部</option>
                                <option value="sales">销售部</option>
                            </select>
                            <div class="validation-error" id="departmentError">请选择所属部门</div>
                        </div>
                    </div>
                </div>
                
                <!-- 缴纳信息 -->
                <div id="paymentInfoSection" style="display: none;">
                    <h3 class="section-title" style="font-size: 1.3rem; margin-top: 25px;">住房公积金缴纳信息</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="housingFundAccount" class="required">公积金账号</label>
                            <input type="text" id="housingFundAccount" name="housingFundAccount" placeholder="请输入公积金账号">
                            <div class="validation-error" id="accountError">请输入有效的公积金账号</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentBase" class="required">缴纳基数（元）</label>
                            <input type="number" id="paymentBase" name="paymentBase" placeholder="请输入缴纳基数" min="0" step="0.01">
                            <div class="validation-error" id="baseError">请输入有效的缴纳基数</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="companyRate" class="required">单位缴纳比例（%）</label>
                            <input type="number" id="companyRate" name="companyRate" placeholder="单位缴纳比例" min="0" max="20" step="0.1" value="12">
                            <div class="validation-error" id="companyRateError">请输入0-20之间的单位缴纳比例</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="personalRate" class="required">个人缴纳比例（%）</label>
                            <input type="number" id="personalRate" name="personalRate" placeholder="个人缴纳比例" min="0" max="20" step="0.1" value="12">
                            <div class="validation-error" id="personalRateError">请输入0-20之间的个人缴纳比例</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="subsidyAmount" class="required">补贴金额（元）</label>
                            <input type="number" id="subsidyAmount" name="subsidyAmount" placeholder="请输入补贴金额" min="0" step="0.01">
                            <div class="validation-error" id="subsidyError">请输入有效的补贴金额</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentMonth">缴纳月份</label>
                            <input type="month" id="paymentMonth" name="paymentMonth" value="">
                        </div>
                    </div>
                    
                    <!-- 计算结果 -->
                    <div class="calculation-section">
                        <h4 style="color: #2c3e50; margin-bottom: 15px;"><i class="fas fa-calculator"></i> 计算结果</h4>
                        <div class="calc-results">
                            <div class="calc-item">
                                <div class="calc-label">单位缴纳金额</div>
                                <div class="calc-value" id="companyAmount">0.00 元</div>
                            </div>
                            <div class="calc-item">
                                <div class="calc-label">个人缴纳金额</div>
                                <div class="calc-value" id="personalAmount">0.00 元</div>
                            </div>
                            <div class="calc-item">
                                <div class="calc-label">总缴纳金额</div>
                                <div class="calc-value" id="totalAmount">0.00 元</div>
                            </div>
                            <div class="calc-item">
                                <div class="calc-label">补贴后实得</div>
                                <div class="calc-value" id="finalAmount">0.00 元</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 银行信息 -->
                <div id="bankInfoSection" style="display: none;">
                    <h3 class="section-title" style="font-size: 1.3rem; margin-top: 25px;">补贴发放银行信息</h3>
                    <p style="margin-bottom: 20px; color: #555;">请填写用于接收住房补贴的银行卡信息，确保信息准确无误。</p>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="bankName" class="required">开户银行</label>
                            <select id="bankName" name="bankName">
                                <option value="">请选择开户银行</option>
                                <option value="icbc">中国工商银行</option>
                                <option value="abc">中国农业银行</option>
                                <option value="boc">中国银行</option>
                                <option value="ccb">中国建设银行</option>
                                <option value="cmb">招商银行</option>
                                <option value="bcm">交通银行</option>
                                <option value="cib">兴业银行</option>
                                <option value="citic">中信银行</option>
                                <option value="spdb">浦发银行</option>
                                <option value="cmbc">民生银行</option>
                                <option value="psbc">中国邮政储蓄银行</option>
                                <option value="other">其他银行</option>
                            </select>
                            <div class="validation-error" id="bankNameError">请选择开户银行</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="bankAccount" class="required">银行卡号</label>
                            <input type="text" id="bankAccount" name="bankAccount" placeholder="请输入银行卡号" maxlength="19">
                            <div class="validation-error" id="bankAccountError">请输入有效的银行卡号</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="accountHolder" class="required">开户人姓名</label>
                            <input type="text" id="accountHolder" name="accountHolder" placeholder="请输入开户人姓名">
                            <div class="validation-error" id="accountHolderError">请输入有效的开户人姓名</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="bankBranch">开户支行（可选）</label>
                            <input type="text" id="bankBranch" name="bankBranch" placeholder="请输入开户支行名称">
                        </div>
                    </div>
                    
                    <div class="security-note">
                        <i class="fas fa-shield-alt"></i>
                        <strong>安全提示：</strong> 银行卡信息将严格加密存储，仅用于补贴发放，不会用于其他用途。请确保您填写的是本人名下的有效银行卡。
                    </div>
                </div>
                
                <!-- 预览部分 -->
                <div id="previewSection" class="preview-section">
                    <h3 class="section-title" style="font-size: 1.3rem; margin-top: 25px;">信息预览</h3>
                    <p>请仔细核对以下信息，确认无误后提交。</p>
                    
                    <table class="preview-table">
                        <thead>
                            <tr>
                                <th>项目</th>
                                <th>信息</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                            <!-- 预览数据将通过JavaScript动态填充 -->
                        </tbody>
                    </table>
                </div>
                
                <!-- 按钮区域 -->
                <div class="actions">
                    <button type="button" class="btn btn-secondary" id="prevBtn" style="display: none;">
                        <i class="fas fa-arrow-left"></i> 上一步
                    </button>
                    
                    <button type="button" class="btn btn-primary" id="nextBtn">
                        下一步 <i class="fas fa-arrow-right"></i>
                    </button>
                    
                    <button type="button" class="btn btn-success" id="submitBtn" style="display: none;">
                        <i class="fas fa-check-circle"></i> 确认提交
                    </button>
                    
                    <button type="button" class="btn btn-secondary" id="resetBtn">
                        <i class="fas fa-redo"></i> 重置表单
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>© 2023 员工住房公积金缴纳信息登记系统 | 本系统数据仅用于公司内部住房补贴发放</p>
            <p style="margin-top: 8px; font-size: 0.85rem;">严格保密 | 依法合规 | 精准发放</p>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 步骤管理
            let currentStep = 1;
            const maxSteps = 4;
            
            // 验证码相关变量
            let verificationCode = '';
            let countdownTimer = null;
            let countdownSeconds = 60;
            
            // 获取DOM元素
            const stepIndicators = document.querySelectorAll('.step');
            const basicInfoSection = document.getElementById('basicInfoSection');
            const paymentInfoSection = document.getElementById('paymentInfoSection');
            const bankInfoSection = document.getElementById('bankInfoSection');
            const previewSection = document.getElementById('previewSection');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');
            const resetBtn = document.getElementById('resetBtn');
            const sendCodeBtn = document.getElementById('sendCodeBtn');
            
            // 表单输入字段
            const formInputs = document.querySelectorAll('input, select');
            
            // 初始化月份字段为当前月份
            const currentDate = new Date();
            const currentMonth = currentDate.getFullYear() + '-' + String(currentDate.getMonth() + 1).padStart(2, '0');
            document.getElementById('paymentMonth').value = currentMonth;
            
            // 发送验证码按钮点击事件
            sendCodeBtn.addEventListener('click', function() {
                const mobilePhone = document.getElementById('mobilePhone').value.trim();
                
                if (!isValidMobilePhone(mobilePhone)) {
                    showError('mobilePhoneError', 'mobilePhone');
                    return;
                }
                
                // 模拟发送验证码
                verificationCode = generateVerificationCode();
                console.log(`验证码已发送到 ${mobilePhone}: ${verificationCode}`); // 在实际应用中，这里应调用短信API
                
                // 显示成功提示
                alert(`验证码已发送到 ${mobilePhone}，请注意查收。\n（演示验证码：${verificationCode}）`);
                
                // 开始倒计时
                startCountdown();
            });
            
            // 下一步按钮点击事件
            nextBtn.addEventListener('click', function() {
                if (validateCurrentStep()) {
                    if (currentStep < maxSteps) {
                        currentStep++;
                        updateStepDisplay();
                    }
                }
            });
            
            // 上一步按钮点击事件
            prevBtn.addEventListener('click', function() {
                if (currentStep > 1) {
                    currentStep--;
                    updateStepDisplay();
                }
            });
            
            // 重置按钮点击事件
            resetBtn.addEventListener('click', function() {
                if (confirm('确定要重置所有表单内容吗？')) {
                    document.getElementById('registrationForm').reset();
                    currentStep = 1;
                    updateStepDisplay();
                    clearValidationErrors();
                    updateCalculations();
                    
                    // 重置验证码相关状态
                    clearCountdown();
                    sendCodeBtn.disabled = false;
                    sendCodeBtn.innerHTML = '<i class="fas fa-sms"></i> 发送验证码';
                    verificationCode = '';
                }
            });
            
            // 提交按钮点击事件
            submitBtn.addEventListener('click', function() {
                if (validateCurrentStep()) {
                    // 在实际应用中，这里应该将数据发送到服务器
                    alert('登记信息提交成功！数据已保存并进入补贴发放流程。');
                    
                    // 模拟提交成功后重置表单
                    document.getElementById('registrationForm').reset();
                    currentStep = 1;
                    updateStepDisplay();
                    clearValidationErrors();
                    updateCalculations();
                    
                    // 重置验证码相关状态
                    clearCountdown();
                    sendCodeBtn.disabled = false;
                    sendCodeBtn.innerHTML = '<i class="fas fa-sms"></i> 发送验证码';
                    verificationCode = '';
                    
                    // 显示成功消息
                    showSuccessMessage();
                }
            });
            
            // 银行卡号格式化（每4位加空格）
            document.getElementById('bankAccount').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                let formattedValue = '';
                
                for (let i = 0; i < value.length; i++) {
                    if (i > 0 && i % 4 === 0) {
                        formattedValue += ' ';
                    }
                    formattedValue += value[i];
                }
                
                e.target.value = formattedValue;
            });
            
            // 手机号输入时自动验证格式
            document.getElementById('mobilePhone').addEventListener('blur', function() {
                const mobilePhone = this.value.trim();
                if (mobilePhone && !isValidMobilePhone(mobilePhone)) {
                    showError('mobilePhoneError', 'mobilePhone');
                }
            });
            
            // 身份证号码输入时自动验证格式
            document.getElementById('idNumber').addEventListener('blur', function() {
                const idNumber = this.value.trim();
                if (idNumber && !isValidIdNumber(idNumber)) {
                    showError('idNumberError', 'idNumber');
                }
            });
            
            // 更新步骤显示
            function updateStepDisplay() {
                // 更新步骤指示器
                stepIndicators.forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    
                    if (index + 1 < currentStep) {
                        step.classList.add('completed');
                    } else if (index + 1 === currentStep) {
                        step.classList.add('active');
                    }
                });
                
                // 显示/隐藏相应部分
                basicInfoSection.style.display = currentStep === 1 ? 'block' : 'none';
                paymentInfoSection.style.display = currentStep === 2 ? 'block' : 'none';
                bankInfoSection.style.display = currentStep === 3 ? 'block' : 'none';
                previewSection.style.display = currentStep === 4 ? 'block' : 'none';
                
                // 更新按钮显示
                prevBtn.style.display = currentStep > 1 ? 'flex' : 'none';
                nextBtn.style.display = currentStep < 4 ? 'flex' : 'none';
                submitBtn.style.display = currentStep === 4 ? 'flex' : 'none';
                
                // 更新下一步按钮文本
                if (currentStep === 3) {
                    nextBtn.innerHTML = '预览信息 <i class="fas fa-arrow-right"></i>';
                } else if (currentStep === 2) {
                    nextBtn.innerHTML = '银行信息 <i class="fas fa-arrow-right"></i>';
                } else {
                    nextBtn.innerHTML = '下一步 <i class="fas fa-arrow-right"></i>';
                }
                
                // 如果当前是第四步，更新预览信息
                if (currentStep === 4) {
                    updatePreview();
                }
            }
            
            // 验证当前步骤
            function validateCurrentStep() {
                let isValid = true;
                
                // 清除之前的错误
                clearValidationErrors();
                
                if (currentStep === 1) {
                    // 验证基本信息
                    const name = document.getElementById('employeeName').value.trim();
                    const employeeId = document.getElementById('employeeId').value.trim();
                    const idNumber = document.getElementById('idNumber').value.trim();
                    const mobilePhone = document.getElementById('mobilePhone').value.trim();
                    const verificationCodeInput = document.getElementById('verificationCode').value.trim();
                    const department = document.getElementById('department').value;
                    
                    if (!name) {
                        showError('nameError', 'employeeName');
                        isValid = false;
                    }
                    
                    if (!employeeId) {
                        showError('idError', 'employeeId');
                        isValid = false;
                    }
                    
                    if (!idNumber || !isValidIdNumber(idNumber)) {
                        showError('idNumberError', 'idNumber');
                        isValid = false;
                    }
                    
                    if (!mobilePhone || !isValidMobilePhone(mobilePhone)) {
                        showError('mobilePhoneError', 'mobilePhone');
                        isValid = false;
                    }
                    
                    if (!verificationCodeInput) {
                        showError('verificationCodeError', 'verificationCode');
                        isValid = false;
                    } else if (verificationCodeInput !== verificationCode) {
                        document.getElementById('verificationCodeError').textContent = '验证码不正确';
                        showError('verificationCodeError', 'verificationCode');
                        isValid = false;
                    }
                    
                    if (!department) {
                        showError('departmentError', 'department');
                        isValid = false;
                    }
                } else if (currentStep === 2) {
                    // 验证缴纳信息
                    const housingFundAccount = document.getElementById('housingFundAccount').value.trim();
                    const paymentBase = document.getElementById('paymentBase').value;
                    const companyRate = document.getElementById('companyRate').value;
                    const personalRate = document.getElementById('personalRate').value;
                    const subsidyAmount = document.getElementById('subsidyAmount').value;
                    
                    if (!housingFundAccount) {
                        showError('accountError', 'housingFundAccount');
                        isValid = false;
                    }
                    
                    if (!paymentBase || parseFloat(paymentBase) <= 0) {
                        showError('baseError', 'paymentBase');
                        isValid = false;
                    }
                    
                    if (!companyRate || parseFloat(companyRate) < 0 || parseFloat(companyRate) > 20) {
                        showError('companyRateError', 'companyRate');
                        isValid = false;
                    }
                    
                    if (!personalRate || parseFloat(personalRate) < 0 || parseFloat(personalRate) > 20) {
                        showError('personalRateError', 'personalRate');
                        isValid = false;
                    }
                    
                    if (!subsidyAmount || parseFloat(subsidyAmount) < 0) {
                        showError('subsidyError', 'subsidyAmount');
                        isValid = false;
                    }
                } else if (currentStep === 3) {
                    // 验证银行信息
                    const bankName = document.getElementById('bankName').value;
                    const bankAccount = document.getElementById('bankAccount').value.replace(/\s+/g, '');
                    const accountHolder = document.getElementById('accountHolder').value.trim();
                    
                    if (!bankName) {
                        showError('bankNameError', 'bankName');
                        isValid = false;
                    }
                    
                    if (!bankAccount || !isValidBankAccount(bankAccount)) {
                        showError('bankAccountError', 'bankAccount');
                        isValid = false;
                    }
                    
                    if (!accountHolder) {
                        showError('accountHolderError', 'accountHolder');
                        isValid = false;
                    }
                }
                
                return isValid;
            }
            
            // 显示错误
            function showError(errorElementId, inputElementId) {
                const errorElement = document.getElementById(errorElementId);
                const inputElement = document.getElementById(inputElementId);
                
                if (errorElement && inputElement) {
                    errorElement.classList.add('show');
                    inputElement.classList.add('input-error');
                }
            }
            
            // 清除验证错误
            function clearValidationErrors() {
                const errorElements = document.querySelectorAll('.validation-error');
                const inputElements = document.querySelectorAll('input, select');
                
                errorElements.forEach(element => {
                    element.classList.remove('show');
                });
                
                inputElements.forEach(element => {
                    element.classList.remove('input-error');
                });
            }
            
            // 验证身份证号码
            function isValidIdNumber(idNumber) {
                // 简单的身份证验证（实际应用中需要更严格的验证）
                return /^\d{17}[\dXx]$/.test(idNumber);
            }
            
            // 验证手机号码
            function isValidMobilePhone(mobilePhone) {
                return /^1[3-9]\d{9}$/.test(mobilePhone);
            }
            
            // 验证银行卡号
            function isValidBankAccount(bankAccount) {
                // 简单的银行卡号验证（实际应用中需要更严格的验证）
                return /^\d{16,19}$/.test(bankAccount);
            }
            
            // 生成随机验证码
            function generateVerificationCode() {
                return Math.floor(100000 + Math.random() * 900000).toString();
            }
            
            // 开始倒计时
            function startCountdown() {
                sendCodeBtn.disabled = true;
                countdownSeconds = 60;
                
                countdownTimer = setInterval(function() {
                    countdownSeconds--;
                    sendCodeBtn.innerHTML = `${countdownSeconds}秒后重新发送`;
                    
                    if (countdownSeconds <= 0) {
                        clearCountdown();
                        sendCodeBtn.disabled = false;
                        sendCodeBtn.innerHTML = '<i class="fas fa-sms"></i> 重新发送验证码';
                    }
                }, 1000);
            }
            
            // 清除倒计时
            function clearCountdown() {
                if (countdownTimer) {
                    clearInterval(countdownTimer);
                    countdownTimer = null;
                }
            }
            
            // 更新预览信息
            function updatePreview() {
                const previewTableBody = document.getElementById('previewTableBody');
                const formData = new FormData(document.getElementById('registrationForm'));
                
                let previewHTML = '';
                
                // 基本信息
                previewHTML += `
                    <tr>
                        <td><strong>员工姓名</strong></td>
                        <td>${formData.get('employeeName')}</td>
                    </tr>
                    <tr>
                        <td><strong>员工工号</strong></td>
                        <td>${formData.get('employeeId')}</td>
                    </tr>
                    <tr>
                        <td><strong>身份证号码</strong></td>
                        <td>${formData.get('idNumber')}</td>
                    </tr>
                    <tr>
                        <td><strong>手机号码</strong></td>
                        <td>${formData.get('mobilePhone')}</td>
                    </tr>
                    <tr>
                        <td><strong>所属部门</strong></td>
                        <td>${getDepartmentName(formData.get('department'))}</td>
                    </tr>
                    <tr>
                        <td colspan="2" style="background-color: #f1f8ff; font-weight: bold;">住房公积金缴纳信息</td>
                    </tr>
                    <tr>
                        <td><strong>公积金账号</strong></td>
                        <td>${formData.get('housingFundAccount')}</td>
                    </tr>
                    <tr>
                        <td><strong>缴纳基数</strong></td>
                        <td>${parseFloat(formData.get('paymentBase') || 0).toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>单位缴纳比例</strong></td>
                        <td>${formData.get('companyRate')}%</td>
                    </tr>
                    <tr>
                        <td><strong>个人缴纳比例</strong></td>
                        <td>${formData.get('personalRate')}%</td>
                    </tr>
                    <tr>
                        <td><strong>单位缴纳金额</strong></td>
                        <td>${calculateCompanyAmount().toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>个人缴纳金额</strong></td>
                        <td>${calculatePersonalAmount().toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>总缴纳金额</strong></td>
                        <td>${calculateTotalAmount().toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>补贴金额</strong></td>
                        <td>${parseFloat(formData.get('subsidyAmount') || 0).toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>补贴后实得</strong></td>
                        <td>${calculateFinalAmount().toFixed(2)} 元</td>
                    </tr>
                    <tr>
                        <td><strong>缴纳月份</strong></td>
                        <td>${formData.get('paymentMonth') || '未指定'}</td>
                    </tr>
                    <tr>
                        <td colspan="2" style="background-color: #f1f8ff; font-weight: bold;">银行信息</td>
                    </tr>
                    <tr>
                        <td><strong>开户银行</strong></td>
                        <td>${getBankName(formData.get('bankName'))}</td>
                    </tr>
                    <tr>
                        <td><strong>银行卡号</strong></td>
                        <td>${formatBankAccount(formData.get('bankAccount'))}</td>
                    </tr>
                    <tr>
                        <td><strong>开户人姓名</strong></td>
                        <td>${formData.get('accountHolder')}</td>
                    </tr>
                    <tr>
                        <td><strong>开户支行</strong></td>
                        <td>${formData.get('bankBranch') || '未填写'}</td>
                    </tr>
                `;
                
                previewTableBody.innerHTML = previewHTML;
            }
            
            // 获取部门名称
            function getDepartmentName(departmentCode) {
                const departments = {
                    'technology': '技术部',
                    'marketing': '市场部',
                    'finance': '财务部',
                    'hr': '人力资源部',
                    'operations': '运营部',
                    'sales': '销售部'
                };
                
                return departments[departmentCode] || departmentCode;
            }
            
            // 获取银行名称
            function getBankName(bankCode) {
                const banks = {
                    'icbc': '中国工商银行',
                    'abc': '中国农业银行',
                    'boc': '中国银行',
                    'ccb': '中国建设银行',
                    'cmb': '招商银行',
                    'bcm': '交通银行',
                    'cib': '兴业银行',
                    'citic': '中信银行',
                    'spdb': '浦发银行',
                    'cmbc': '民生银行',
                    'psbc': '中国邮政储蓄银行',
                    'other': '其他银行'
                };
                
                return banks[bankCode] || bankCode;
            }
            
            // 格式化银行卡号显示
            function formatBankAccount(bankAccount) {
                if (!bankAccount) return '';
                return bankAccount.replace(/(\d{4})(?=\d)/g, '$1 ');
            }
            
            // 计算函数
            function calculateCompanyAmount() {
                const base = parseFloat(document.getElementById('paymentBase').value) || 0;
                const rate = parseFloat(document.getElementById('companyRate').value) || 0;
                return base * rate / 100;
            }
            
            function calculatePersonalAmount() {
                const base = parseFloat(document.getElementById('paymentBase').value) || 0;
                const rate = parseFloat(document.getElementById('personalRate').value) || 0;
                return base * rate / 100;
            }
            
            function calculateTotalAmount() {
                return calculateCompanyAmount() + calculatePersonalAmount();
            }
            
            function calculateFinalAmount() {
                const subsidy = parseFloat(document.getElementById('subsidyAmount').value) || 0;
                return calculatePersonalAmount() + subsidy;
            }
            
            // 更新计算结果
            function updateCalculations() {
                document.getElementById('companyAmount').textContent = calculateCompanyAmount().toFixed(2) + ' 元';
                document.getElementById('personalAmount').textContent = calculatePersonalAmount().toFixed(2) + ' 元';
                document.getElementById('totalAmount').textContent = calculateTotalAmount().toFixed(2) + ' 元';
                document.getElementById('finalAmount').textContent = calculateFinalAmount().toFixed(2) + ' 元';
            }
            
            // 显示成功消息
            function showSuccessMessage() {
                const successHTML = `
                    <div class="registration-card" style="border-left-color: #27ae60;">
                        <h2 class="section-title" style="color: #27ae60;">
                            <i class="fas fa-check-circle"></i> 登记成功
                        </h2>
                        <p>员工住房公积金缴纳信息已成功提交，该员工将进入住房补贴发放流程。</p>
                        <div style="margin-top: 20px; padding: 15px; background-color: #eafaf1; border-radius: 4px;">
                            <p><strong>下一步操作：</strong></p>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>财务部门将审核提交的信息</li>
                                <li>审核通过后，补贴金额将随下月工资一并发放到指定银行卡</li>
                                <li>员工可登录内部系统查看补贴发放状态</li>
                            </ul>
                        </div>
                        <div style="text-align: center; margin-top: 25px;">
                            <button type="button" class="btn btn-primary" onclick="location.reload()">
                                <i class="fas fa-plus-circle"></i> 登记新员工
                            </button>
                        </div>
                    </div>
                `;
                
                // 在实际应用中，这里可能需要替换整个表单区域
                document.querySelector('.registration-card').style.display = 'none';
                document.querySelector('.step-indicator').style.display = 'none';
                document.querySelector('.info-box').style.display = 'none';
                
                const container = document.querySelector('.container');
                const newCard = document.createElement('div');
                newCard.innerHTML = successHTML;
                container.insertBefore(newCard, document.querySelector('footer'));
            }
            
            // 添加输入事件监听器，实时更新计算结果
            document.getElementById('paymentBase').addEventListener('input', updateCalculations);
            document.getElementById('companyRate').addEventListener('input', updateCalculations);
            document.getElementById('personalRate').addEventListener('input', updateCalculations);
            document.getElementById('subsidyAmount').addEventListener('input', updateCalculations);
            
            // 初始化计算
            updateCalculations();
        });
    </script>
</body>
</html>